import{t as E,o as x,V,u as I,w as M,h as Q,P as G,O as W,F as J,a as f,R as F}from"./focus-management-BVcv6Qz0.js";import{x as X,a as g}from"./index-DazkXZ4Z.js";import{p as Y,l as j,y as Z,c as _}from"./use-outside-click--EiZLOTR.js";import{b as $}from"./use-resolve-button-type-CBgqNcOC.js";import{f as ee,a as te}from"./hidden-B8Q8y74T.js";import{k as R,m,l as A,z as C,D as ae,A as le,C as oe,B as T,x as z,F as ie,E as ne,y as L,G as ue}from"./index-DDNgua1v.js";function N(t={},n=null,i=[]){for(let[O,e]of Object.entries(t))H(i,U(n,O),e);return i}function U(t,n){return t?t+"["+n+"]":n}function H(t,n,i){if(Array.isArray(i))for(let[O,e]of i.entries())H(t,U(n,O.toString()),e);else i instanceof Date?t.push([n,i.toISOString()]):typeof i=="boolean"?t.push([n,i?"1":"0"]):typeof i=="string"?t.push([n,i]):typeof i=="number"?t.push([n,`${i}`]):i==null?t.push([n,""]):N(i,n,t)}function re(t,n,i){let O=R(i==null?void 0:i.value),e=m(()=>t.value!==void 0);return[m(()=>e.value?t.value:O.value),function(p){return e.value||(O.value=p),n==null?void 0:n(p)}]}function se(t,n){return t===n}var ve=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(ve||{}),de=(t=>(t[t.Single=0]="Single",t[t.Multi=1]="Multi",t))(de||{}),pe=(t=>(t[t.Pointer=0]="Pointer",t[t.Other=1]="Other",t))(pe||{});function ce(t){requestAnimationFrame(()=>requestAnimationFrame(t))}let K=Symbol("ListboxContext");function B(t){let n=ne(K,null);if(n===null){let i=new Error(`<${t} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,B),i}return n}let ye=A({name:"Listbox",emits:{"update:modelValue":t=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],default:()=>se},horizontal:{type:[Boolean],default:!1},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},name:{type:String,optional:!0},multiple:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(t,{slots:n,attrs:i,emit:O}){let e=R(1),p=R(null),b=R(null),h=R(null),s=R([]),y=R(""),a=R(null),l=R(1);function w(o=u=>u){let u=a.value!==null?s.value[a.value]:null,r=W(o(s.value.slice()),S=>x(S.dataRef.domRef)),d=u?r.indexOf(u):null;return d===-1&&(d=null),{options:r,activeOptionIndex:d}}let k=m(()=>t.multiple?1:0),[P,v]=re(m(()=>t.modelValue),o=>O("update:modelValue",o),m(()=>t.defaultValue)),c={listboxState:e,value:P,mode:k,compare(o,u){if(typeof t.by=="string"){let r=t.by;return(o==null?void 0:o[r])===(u==null?void 0:u[r])}return t.by(o,u)},orientation:m(()=>t.horizontal?"horizontal":"vertical"),labelRef:p,buttonRef:b,optionsRef:h,disabled:m(()=>t.disabled),options:s,searchQuery:y,activeOptionIndex:a,activationTrigger:l,closeListbox(){t.disabled||e.value!==1&&(e.value=1,a.value=null)},openListbox(){t.disabled||e.value!==0&&(e.value=0)},goToOption(o,u,r){if(t.disabled||e.value===1)return;let d=w(),S=X(o===g.Specific?{focus:g.Specific,id:u}:{focus:o},{resolveItems:()=>d.options,resolveActiveIndex:()=>d.activeOptionIndex,resolveId:D=>D.id,resolveDisabled:D=>D.dataRef.disabled});y.value="",a.value=S,l.value=r??1,s.value=d.options},search(o){if(t.disabled||e.value===1)return;let u=y.value!==""?0:1;y.value+=o.toLowerCase();let r=(a.value!==null?s.value.slice(a.value+u).concat(s.value.slice(0,a.value+u)):s.value).find(S=>S.dataRef.textValue.startsWith(y.value)&&!S.dataRef.disabled),d=r?s.value.indexOf(r):-1;d===-1||d===a.value||(a.value=d,l.value=1)},clearSearch(){t.disabled||e.value!==1&&y.value!==""&&(y.value="")},registerOption(o,u){let r=w(d=>[...d,{id:o,dataRef:u}]);s.value=r.options,a.value=r.activeOptionIndex},unregisterOption(o){let u=w(r=>{let d=r.findIndex(S=>S.id===o);return d!==-1&&r.splice(d,1),r});s.value=u.options,a.value=u.activeOptionIndex,l.value=1},select(o){t.disabled||v(I(k.value,{0:()=>o,1:()=>{let u=L(c.value.value).slice(),r=L(o),d=u.findIndex(S=>c.compare(r,L(S)));return d===-1?u.push(r):u.splice(d,1),u}}))}};return Z([b,h],(o,u)=>{var r;c.closeListbox(),Q(u,J.Loose)||(o.preventDefault(),(r=x(b))==null||r.focus())},m(()=>e.value===0)),ue(K,c),_(m(()=>I(e.value,{0:j.Open,1:j.Closed}))),()=>{let{name:o,modelValue:u,disabled:r,...d}=t,S={open:e.value===0,disabled:r,value:P.value};return z(ie,[...o!=null&&P.value!=null?N({[o]:P.value}).map(([D,q])=>z(ee,G({features:te.Hidden,key:D,as:"input",type:"hidden",hidden:!0,readOnly:!0,name:D,value:q}))):[],V({ourProps:{},theirProps:{...i,...M(d,["defaultValue","onUpdate:modelValue","horizontal","multiple","by"])},slot:S,slots:n,attrs:i,name:"Listbox"})])}}}),Se=A({name:"ListboxButton",props:{as:{type:[Object,String],default:"button"}},setup(t,{attrs:n,slots:i,expose:O}){let e=B("ListboxButton"),p=`headlessui-listbox-button-${E()}`;O({el:e.buttonRef,$el:e.buttonRef});function b(a){switch(a.key){case f.Space:case f.Enter:case f.ArrowDown:a.preventDefault(),e.openListbox(),T(()=>{var l;(l=x(e.optionsRef))==null||l.focus({preventScroll:!0}),e.value.value||e.goToOption(g.First)});break;case f.ArrowUp:a.preventDefault(),e.openListbox(),T(()=>{var l;(l=x(e.optionsRef))==null||l.focus({preventScroll:!0}),e.value.value||e.goToOption(g.Last)});break}}function h(a){switch(a.key){case f.Space:a.preventDefault();break}}function s(a){e.disabled.value||(e.listboxState.value===0?(e.closeListbox(),T(()=>{var l;return(l=x(e.buttonRef))==null?void 0:l.focus({preventScroll:!0})})):(a.preventDefault(),e.openListbox(),ce(()=>{var l;return(l=x(e.optionsRef))==null?void 0:l.focus({preventScroll:!0})})))}let y=$(m(()=>({as:t.as,type:n.type})),e.buttonRef);return()=>{var a,l;let w={open:e.listboxState.value===0,disabled:e.disabled.value,value:e.value.value},k={ref:e.buttonRef,id:p,type:y.value,"aria-haspopup":!0,"aria-controls":(a=x(e.optionsRef))==null?void 0:a.id,"aria-expanded":e.disabled.value?void 0:e.listboxState.value===0,"aria-labelledby":e.labelRef.value?[(l=x(e.labelRef))==null?void 0:l.id,p].join(" "):void 0,disabled:e.disabled.value===!0?!0:void 0,onKeydown:b,onKeyup:h,onClick:s};return V({ourProps:k,theirProps:t,slot:w,attrs:n,slots:i,name:"ListboxButton"})}}}),he=A({name:"ListboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0}},setup(t,{attrs:n,slots:i,expose:O}){let e=B("ListboxOptions"),p=`headlessui-listbox-options-${E()}`,b=R(null);O({el:e.optionsRef,$el:e.optionsRef});function h(a){switch(b.value&&clearTimeout(b.value),a.key){case f.Space:if(e.searchQuery.value!=="")return a.preventDefault(),a.stopPropagation(),e.search(a.key);case f.Enter:if(a.preventDefault(),a.stopPropagation(),e.activeOptionIndex.value!==null){let l=e.options.value[e.activeOptionIndex.value];e.select(l.dataRef.value)}e.mode.value===0&&(e.closeListbox(),T(()=>{var l;return(l=x(e.buttonRef))==null?void 0:l.focus({preventScroll:!0})}));break;case I(e.orientation.value,{vertical:f.ArrowDown,horizontal:f.ArrowRight}):return a.preventDefault(),a.stopPropagation(),e.goToOption(g.Next);case I(e.orientation.value,{vertical:f.ArrowUp,horizontal:f.ArrowLeft}):return a.preventDefault(),a.stopPropagation(),e.goToOption(g.Previous);case f.Home:case f.PageUp:return a.preventDefault(),a.stopPropagation(),e.goToOption(g.First);case f.End:case f.PageDown:return a.preventDefault(),a.stopPropagation(),e.goToOption(g.Last);case f.Escape:a.preventDefault(),a.stopPropagation(),e.closeListbox(),T(()=>{var l;return(l=x(e.buttonRef))==null?void 0:l.focus({preventScroll:!0})});break;case f.Tab:a.preventDefault(),a.stopPropagation();break;default:a.key.length===1&&(e.search(a.key),b.value=setTimeout(()=>e.clearSearch(),350));break}}let s=Y(),y=m(()=>s!==null?s.value===j.Open:e.listboxState.value===0);return()=>{var a,l,w,k;let P={open:e.listboxState.value===0},v={"aria-activedescendant":e.activeOptionIndex.value===null||(a=e.options.value[e.activeOptionIndex.value])==null?void 0:a.id,"aria-multiselectable":e.mode.value===1?!0:void 0,"aria-labelledby":(k=(l=x(e.labelRef))==null?void 0:l.id)!=null?k:(w=x(e.buttonRef))==null?void 0:w.id,"aria-orientation":e.orientation.value,id:p,onKeydown:h,role:"listbox",tabIndex:0,ref:e.optionsRef};return V({ourProps:v,theirProps:t,slot:P,attrs:n,slots:i,features:F.RenderStrategy|F.Static,visible:y.value,name:"ListboxOptions"})}}}),Re=A({name:"ListboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1}},setup(t,{slots:n,attrs:i,expose:O}){let e=B("ListboxOption"),p=`headlessui-listbox-option-${E()}`,b=R(null);O({el:b,$el:b});let h=m(()=>e.activeOptionIndex.value!==null?e.options.value[e.activeOptionIndex.value].id===p:!1),s=m(()=>I(e.mode.value,{0:()=>e.compare(L(e.value.value),L(t.value)),1:()=>L(e.value.value).some(v=>e.compare(L(v),L(t.value)))})),y=m(()=>I(e.mode.value,{1:()=>{var v;let c=L(e.value.value);return((v=e.options.value.find(o=>c.some(u=>e.compare(L(u),L(o.dataRef.value)))))==null?void 0:v.id)===p},0:()=>s.value})),a=m(()=>({disabled:t.disabled,value:t.value,textValue:"",domRef:b}));C(()=>{var v,c;let o=(c=(v=x(b))==null?void 0:v.textContent)==null?void 0:c.toLowerCase().trim();o!==void 0&&(a.value.textValue=o)}),C(()=>e.registerOption(p,a)),ae(()=>e.unregisterOption(p)),C(()=>{le([e.listboxState,s],()=>{e.listboxState.value===0&&(!s.value||I(e.mode.value,{1:()=>{y.value&&e.goToOption(g.Specific,p)},0:()=>{e.goToOption(g.Specific,p)}}))},{immediate:!0})}),oe(()=>{e.listboxState.value===0&&(!h.value||e.activationTrigger.value!==0&&T(()=>{var v,c;return(c=(v=x(b))==null?void 0:v.scrollIntoView)==null?void 0:c.call(v,{block:"nearest"})}))});function l(v){if(t.disabled)return v.preventDefault();e.select(t.value),e.mode.value===0&&(e.closeListbox(),T(()=>{var c;return(c=x(e.buttonRef))==null?void 0:c.focus({preventScroll:!0})}))}function w(){if(t.disabled)return e.goToOption(g.Nothing);e.goToOption(g.Specific,p)}function k(){t.disabled||h.value||e.goToOption(g.Specific,p,0)}function P(){t.disabled||!h.value||e.goToOption(g.Nothing)}return()=>{let{disabled:v}=t,c={active:h.value,selected:s.value,disabled:v},o={id:p,ref:b,role:"option",tabIndex:v===!0?void 0:-1,"aria-disabled":v===!0?!0:void 0,"aria-selected":s.value,disabled:void 0,onClick:l,onFocus:w,onPointermove:k,onMousemove:k,onPointerleave:P,onMouseleave:P};return V({ourProps:o,theirProps:M(t,["value","disabled"]),slot:c,attrs:i,slots:n,name:"ListboxOption"})}}});export{Re as A,Se as I,ye as M,he as V,re as d,N as e};
